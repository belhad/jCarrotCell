/*!
 * jCarrotCell
 * http://jcarrotcell.yujulia.com
 * 
 * Copyright 2011, 2015 
 * Released under the MIT license
 *
 */
!function(e){var n={carrots:{},defaults:{},count:0,makeCarrot:function(){var n,t,o,i,a,r,s,l,c,d,u,f,p,m,v,h,C,g,S,w,y,b,k,x,W,T,E,H,I,P=null,D=!0,L={step:0,key:!1,sideways:!0,infinite:!1,auto:!1,speed:500,navi:!1,makeNavi:!1,delay:5e3,containsControl:!0,controlScope:"",stopOnClick:!1,pauseOnHover:!1,disabledClass:"disabled",currentClass:"current",cloneClass:"clone",naviClass:"naviItem",sliderSelect:"ol",sliderChildSelect:"li",prevSelect:".prev",nextSelect:".next",pauseSelect:".pause",playSelect:".play",stopSelect:".stop",naviContainer:".navi",naviSelect:"> *",scrollStart:"carrotScrollStart",scrollEnd:"carrotScrollEnd",atStart:"carrotAtStart",atEnd:"carrotAtEnd",onPlay:"carrotPlay",onPause:"carrotPause",onStop:"carrotStop",pagesChanged:"carrotPageCountChanged",onRemove:"carrotRemove",onEmpty:"carrotEmpty",onInsert:"carrotInsert",onReload:"carrotReload",useMaxWidth:!1,maxWidth:0,maxHeight:0,minWidth:0,minHeight:0},N=37,R=39,M=38,O=40,A="scrollEnd",B="scrollStart",F="atStart",j="atEnd",z="onPlay",q="onPause",Q="onStop",U="remove",V="empty",G="insert",J="reload",K="pageCountChanged",X=!1,Y=!1,Z=!0,$=1,_=!1,ee=!1,ne=!1,te=!1,oe=0,ie=!1,ae=!0,re=!0,se=!1,le=null,ce=null,de={},ue=function(e){D&&console.log(e)},fe=function(){var e={};return function(n,t,o){o||(o="default"),e[o]&&clearTimeout(e[o]),e[o]=setTimeout(n,t)}}(),pe=function(){fe(he,200,"carrotWindowResize")},me=function(){var n=t;if(L.maxWidth&&n>L.maxWidth&&(n=L.maxWidth),L.minWidth&&n<L.minWidth&&(n=L.minWidth),L.useOffset)n-=L.useOffset;else{P.css("margin-left","0").css("margin-right","0");var i=2*P.offset().left;n-=i}var r=n/o;L.maxHeight&&r>L.maxHeight&&(r=L.maxHeight),L.minHeight&&r<L.minHeight&&(r=L.minHeight),e(P).css("width",n+"px"),e(a).css("width",n+"px"),e(s).css("width",n+"px"),L.resizeHeight&&e(s).css("height",r+"px")},ve=function(){t=n.innerWidth(),me(),d=L.sideways?l.outerWidth(!0):l.outerHeight(!0),Ve()},he=function(){ve();var e=$;(e>1||L.infinite)&&(Se(),be(e,"no"))},Ce=function(){e(P).css("width","0"),he()},ge=function(e,n){L.sideways?a.scrollLeft(e):a.scrollTop(e),g=n,$=n,te=!1,L.controlScope.trigger(L.scrollEnd,[L.name,A,n])},Se=function(){var e=0;L.infinite&&(e=d*h),ge(e,1)},we=function(){var e=d*s.length;L.infinite&&(e=d*(s.length-2*h)),ge(e,S)},ye=function(){if(L.infinite&&g>S){L.controlScope.trigger(L.scrollStart,[L.name,B,1]),te=!0;var e=(h-oe)*d;L.sideways?a.animate({scrollLeft:"+="+e},L.speed,Se):a.animate({scrollTop:"+="+e},L.speed,Se)}else if(L.infinite&&0===g){L.controlScope.trigger(L.scrollStart,[L.name,B,S]),te=!0;var n=-1*oe*d;L.sideways?a.animate({scrollLeft:"+="+n},L.speed,we):a.animate({scrollTop:"+="+n},L.speed,we)}else $=g,L.controlScope.trigger(L.scrollEnd,[L.name,A,g]),te=!1,ke(g),"function"==typeof le&&le(),le=null},be=function(e,n){if(!arguments.length)return!1;g=e;var t=$>g?-1:1,o=Math.abs($-g),i=d*t*C*o;L.controlScope.trigger(L.scrollStart,[L.name,B,g]),te=!0,L.sideways?n?a.filter(":not(:animated)").animate({scrollLeft:"+="+i},0,ye):a.filter(":not(:animated)").animate({scrollLeft:"+="+i},L.speed,ye):n?a.filter(":not(:animated)").animate({scrollTop:"+="+i},0,ye):a.filter(":not(:animated)").animate({scrollTop:"+="+i},L.speed,ye)},ke=function(e){L.infinite?(Y=!0,Z=!0):(Y=1>=e||1===$?!1:!0,Z=e>=S?!1:!0,se&&(Z=!0)),Y?(w.removeClass(L.disabledClass),ae=!1):(ae=!0,w.addClass(L.disabledClass),L.controlScope.trigger(L.atStart,[L.name,F])),Z?(y.removeClass(L.disabledClass),re=!1):(y.addClass(L.disabledClass),L.controlScope.trigger(L.atEnd,[L.name,j]),re=!0)},xe=function(){L.controlScope.trigger(L.scrollEnd,[L.name,A,S]),te=!1,ke(S)},We=function(){L.controlScope.trigger(L.scrollStart,[L.name,B,S]),te=!0,L.sideways?a.filter(":not(:animated)").animate({scrollLeft:"+="+d},L.speed,xe):a.filter(":not(:animated)").animate({scrollTop:"+="+d},L.speed,xe)},Te=function(){if(!L.infinite&&ae)return!1;var e=$-1;be(e)},Ee=function(){if(!L.infinite&&re)return!1;var e=$+1;se&&!L.infinite?(se=!1,0===I?be(e):We()):be(e)},He=function(){window.clearInterval(f),f=this.setInterval(function(){ee||Ee()},L.delay)},Ie=function(){return ee?!1:(ee=!0,_=!1,ne=!1,p.addClass(L.disabledClass),m.removeClass(L.disabledClass),v.removeClass(L.disabledClass),void L.controlScope.trigger(L.onPause,[L.name,q]))},Pe=function(){return _?!1:(ee=!1,ne=!1,_=!0,m.addClass(L.disabledClass),v.removeClass(L.disabledClass),p.removeClass(L.disabledClass),He(),void L.controlScope.trigger(L.onPlay,[L.name,z]))},De=function(){return ne?!1:(ee=!1,ne=!0,_=!1,v.addClass(L.disabledClass),m.removeClass(L.disabledClass),p.removeClass(L.disabledClass),window.clearInterval(f),void L.controlScope.trigger(L.onStop,[L.name,Q]))},Le=function(){p.bind("click",function(e){e.preventDefault(),Ie()}).show(),m.bind("click",function(e){e.preventDefault(),Pe()}).show(),v.bind("click",function(e){e.preventDefault(),De()}).show(),Pe()},Ne=function(){e(document).keyup(function(e){return te?!1:(e.keyCode==L.keyBack&&Te(),void(e.keyCode==L.keyForward&&Ee()))})},Re=function(){L.controlScope.bind(L.pagesChanged,function(n,t,o,i,a){var r,s,l=i-a,c=!0;if(0>l&&(c=!1),l=Math.abs(l),c){if(L.makeNavi){for(var d=1;c>=d;d++)r=a+d,e(T).append(de[r]?x+de[r]+W:x+r+W),s=e("> *",T).last(),b=e(T).find("> *"),Be(s,r);L.scrollToInserted&&(e(b).removeClass(L.currentClass),e(s).addClass(L.currentClass))}}else b.slice(-1*l).remove(),b=e(T).find("> *")})},Me=function(){L.controlScope.bind(L.scrollStart,function(n,t,o,i){if(t==L.name&&o==B){e(b).removeClass(L.currentClass),i>S&&(i=1),0===i&&(i=S);var a=e(b)[parseInt(i)-1];e(a).addClass(L.currentClass)}})},Oe=function(){b=T.find(L.naviSelect),Fe()},Ae=function(){e(T).empty();for(var n=1;S>=n;n++)de[n]=n;k=e(T).data("navi"),null!==k&&void 0!==k&&0!==k.length&&e(k).each(function(e){de[e+1]=k[e]}),x='<div class="'+L.naviClass+'">',W="</div>",(e(T).is("ul")||e(T).is("ol"))&&(x='<li class="'+L.naviClass+'">',W="</li>");for(var t=1;S>=t;t++)e(T).append(x+de[t]+W);b=e(T).find("> *")},Be=function(n,t){e(n).unbind().bind("click",function(){return _&&L.stopOnClick&&De(),te?!1:(b.removeClass(L.currentClass),e(this).addClass(L.currentClass),void(S>=t&&t>0&&(be(t),ke(t))))})},Fe=function(){b.each(function(e){var n=this,t=e+1;Be(n,t)})},je=function(){L.makeNavi&&Ae(),e(b).first().addClass(L.currentClass),Fe(),Me(),Re()},ze=function(){w.bind("click",function(e){e.preventDefault(),Te()}).show(),y.bind("click",function(e){e.preventDefault(),Ee()}).show()},qe=function(){jQuery().touchwipe&&e(P).touchwipe(L.sideways?{wipeLeft:function(){Ee()},wipeRight:function(){Te()},preventDefaultEvents:!1}:{wipeDown:function(){Ee()},wipeUp:function(){Te()},preventDefaultEvents:!1})},Qe=function(){L.pauseOnHover&&L.auto&&a.bind({mouseenter:function(){Ie()},mouseleave:function(){Pe()}})},Ue=function(){ze(),qe(),Qe(),L.navi&&je(),L.key&&Ne(),L.auto&&Le()},Ve=function(){var e=d*s.length;L.sideways?r.css("width",e+"px"):r.css("height",e+"px")},Ge=function(){S=Math.ceil(h===C||L.auto?c/C:(c-(h-C))/C),null!==ce&&ce!==S&&L.controlScope.trigger(L.pagesChanged,[L.name,K,S,ce]),ce=S},Je=function(){E=(S-1)*C+1,oe=c-E+1,0===oe&&(oe=h),H=C-c%C,H==h&&(H=0),I=H},Ke=function(){s.filter(":first").before(s.slice(-h).clone().addClass(L.cloneClass)),s.filter(":last").after(s.slice(0,h).clone().addClass(L.cloneClass)),s=r.children(L.sliderChildSelect)},Xe=function(){s.filter("."+L.cloneClass).remove(),en(),Ke(),Ve()},Ye=function(){L.sideways?a.scrollLeft(d*h):a.scrollTop(d*h)},Ze=function(){L.auto&&(L.infinite=!0),C=L.step?L.step:h,L.makeNavi&&(L.navi=!0),L.key&&(L.sideways?(L.keyBack=L.keyBack||N,L.keyForward=L.keyForward||R):(L.keyBack=L.keyBack||M,L.keyForward=L.keyForward||O)),Ge(),Je(),L.infinite&&Ke(),Ve(),a.css("overflow","hidden"),L.sideways?a.scrollLeft(0):a.scrollTop(0),L.infinite?Ye():w.addClass(L.disabledClassd),ke(0)},$e=function(){h>=c?(w.addClass(L.disabledClass),y.addClass(L.disabledClass),L.navi&&T.addClass(L.disabledClass),ie=!1):(L.navi&&T.removeClass(L.disabledClass),ie=!0)},_e=function(){u=L.sideways?P.innerWidth():P.innerHeight(),h=Math.floor(u/d)},en=function(){s=r.children(L.sliderChildSelect),c=r.children(L.sliderChildSelect).filter(":not(."+L.cloneClass+")").length,l=s.filter(":first"),d=L.sideways?l.outerWidth(!0):l.outerHeight(!0)},nn=function(){L.controlScope=L.containsControl?P:e(""!==L.controlScope?L.controlScope:"body")},tn=function(){w=L.controlScope.find(L.prevSelect),y=L.controlScope.find(L.nextSelect),p=L.controlScope.find(L.pauseSelect),m=L.controlScope.find(L.playSelect),v=L.controlScope.find(L.stopSelect),T=L.controlScope.find(L.naviContainer),b=T.find(L.naviSelect)},on=function(){if(("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)&&(X=!0),n=e(window),a=P.children(".carrotCellView:first"),r=a.children(L.sliderSelect),nn(),tn(),en(),L.useMaxWidth){var t=s.filter(":first");o=t.outerWidth()/t.outerHeight(),ve(),X?e(window).on("orientationchange",Ce):e(window).on("resize",pe)}_e(),$e(),ie?(Ze(),Ue()):ue("can not scroll content, too large or not enough")},an=function(){en(),Ge(),Je(),L.infinite&&Ke(),Ve(),L.infinite&&Ye()},rn=function(e){for(var n=0,t=0;S>t;t++){var o=t*C+C,i=t*C+1;o>=e&&e>=i&&(n=t)}return n++,e>c&&(n=S),n},sn=function(e){return e=parseInt(e),isNaN(e)?e=s.length+1:1>e?e=1:e>s.length&&(e=s.length+1),e},ln=function(){e(s).remove(),an(),$e(),L.controlScope.trigger(L.onEmpty,[L.name,V])},cn=function(n){var t=n;L.infinite||L.auto?(t=h+n,t>c+h?t=c+h:h>n&&(t=h)):n>c&&(t=c),e(s[t-1]).remove(),(L.infinite||L.auto)&&Xe(),h>I?I++:I=0,an(),$e(),L.controlScope.trigger(L.onRemove,[L.name,U,S])},dn=function(n,t){var o=t;L.infinite||L.auto?(o=t>s.length?c+h:t-1+h,e(L.sliderChildSelect,r).eq(o).before(n),Xe()):t>s.length?r.append(n):e(L.sliderChildSelect,r).eq(t-1).before(n),I>0?I--:I=h-1,an()},un=function(e){if(L.scrollToInserted){var n=rn(e);n!=S||L.infinite?be(n):$!==S?(le=We,be(S)):We()}else $!=S||L.inifnite?ke($):(se=!0,ke(S));L.controlScope.trigger(L.onInsert,[L.name,G,S])},fn=function(e){L.auto&&De(),ln(),r.append(e),an(),je(),be(1),ke(1),L.infinite||$e(),L.auto&&Pe(),L.controlScope.trigger(L.onReload,[L.name,J,S])};return{init:function(n){e.extend(L,n),P=e(n.scope),on(),"function"==typeof L.carrotDone&&L.carrotDone(this)},getName:function(){return L.name},getPageCount:function(){return S},getTotalItems:function(){return c},getSettings:function(){return L},getOpenSpot:function(){return I},forward:function(){Ee()},backward:function(){Te()},stop:function(){De()},play:function(){Pe()},pause:function(){Ie()},updateNavi:function(){Oe()},moveToPage:function(e){e=sn(e),e>S&&(e=S),be(e)},reloadWith:function(e){return s?(fn(e),S):!1},empty:function(){ln()},remove:function(e){return e=sn(e),cn(e),c},insert:function(e,n){return e?(n=sn(n),dn(e,n),un(n),c):!1},setAPI:function(e){i=e}}},init:function(t){return t&&e.extend(t,n.defaults),this.each(function(){n.count++;var o=t||{};o.scope=this,o.name=e(o.scope).attr("id")||"defaultCarrot"+n.count,n.carrots[o.name]=new n.makeCarrot,n.carrots[o.name].init(o),n.carrots[o.name].setAPI(n.carrots[o.name]);var i=e(this).data("carrotCell");i||e(this).data("carrotCell",n.carrots[o.name])})}};e.fn.carrotCell=function(t){return n[t]?n[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jCarrotCell"):n.init.apply(this,arguments)}}(jQuery);